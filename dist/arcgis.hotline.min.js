define(["esri/layers/Layer","esri/geometry/Point","esri/geometry/support/webMercatorUtils","esri/views/2d/layers/BaseLayerView2D"],function(e,u,m,t){this.min=0,this.max=1,this.palette={};let r=t.createSubclass({constructor:e=>{this.view=e.view,this.layer=e.layer},attach:()=>{},render:e=>{var t=e.state,e=e.context;e.globalCompositeOperation="source-over",e.lineCap="round",i(e,t,this.layer.data,this.layer.weight,this.layer.outlineWidth,this.layer.outlineColor),o(e,t,this.layer.data,this.layer.weight)},detach(){this.view.container.removeChild(this.canvas)}});t=e.createSubclass({properties:{min:0,max:1,palette:{0:"green",.5:"yellow",1:"red"},weight:5,outlineWidth:1,outlineColor:"black"},constructor:e=>{this.min=e.min,this.max=e.max,a(e.palette)},createLayerView:function(e){if("2d"===e.type)return new r({view:e,layer:this})}});let i=(e,t,r,i,a,o)=>{var l,n,h,s,c;if(a)for(l=0,h=r.length;l<h;l++)for(s=r[l],e.lineWidth=i+2*a,n=1,c=s.length;n<c;n++){var d=s[n-1],g=s[n],d=new u({longitude:d[0],latitude:d[1]}),g=new u({longitude:g[0],latitude:g[1]}),d=m.geographicToWebMercator(d),g=m.geographicToWebMercator(g),y=[0,0],d=(t.toScreen(y,d.x,d.y),[0,0]);t.toScreen(d,g.x,g.y),e.strokeStyle=o,e.beginPath(),e.moveTo(y[0],y[1]),e.lineTo(d[0],d[1]),e.stroke()}},a=e=>{var t,r=document.createElement("canvas"),i=r.getContext("2d"),a=i.createLinearGradient(0,0,0,256);for(t in r.width=1,r.height=256,e||{0:"green",.5:"yellow",1:"red"})a.addColorStop(t,e[t]);i.fillStyle=a,i.fillRect(0,0,1,256),this.palette=i.getImageData(0,0,1,256).data},o=(e,t,r,i)=>{var a,o,l,n,h;for(e.lineWidth=i,a=0,l=r.length;a<l;a++)for(o=1,h=(n=r[a]).length;o<h;o++){var s=n[o-1],c=n[o],d=new u({longitude:s[0],latitude:s[1]}),g=new u({longitude:c[0],latitude:c[1]}),d=m.geographicToWebMercator(d),g=m.geographicToWebMercator(g),y=[0,0],d=(t.toScreen(y,d.x,d.y),[0,0]);t.toScreen(d,g.x,g.y),g=e.createLinearGradient(y[0],y[1],d[0],d[1]),s=p(s[2]),c=p(c[2]),g.addColorStop(0,"rgb("+s.join(",")+")"),g.addColorStop(1,"rgb("+c.join(",")+")"),e.strokeStyle=g,e.beginPath(),e.moveTo(y[0],y[1]),e.lineTo(d[0],d[1]),e.stroke()}},p=e=>{e=Math.min(Math.max((e-this.min)/(this.max-this.min),0),.999),e=4*Math.floor(256*e);return[this.palette[e],this.palette[1+e],this.palette[2+e]]};return t});
