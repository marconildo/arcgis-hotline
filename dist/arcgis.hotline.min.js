define(["esri/layers/Layer","esri/geometry/Point","esri/geometry/support/webMercatorUtils","esri/views/2d/layers/BaseLayerView2D"],function(e,y,m,t){this.min=0,this.max=1,this.palette={};let i=t.createSubclass({constructor:e=>{this.view=e.view,this.layer=e.layer},attach:()=>{var e=document.createElement("canvas");e.width=this.view.width,e.height=this.view.height,this.context=e.getContext("2d"),this.view.surface.appendChild(e)},render:e=>{var t=e.state,e=e.context;e.globalCompositeOperation="source-over",e.lineCap="round",r(e,t,this.layer.data,this.layer.weight,this.layer.outlineWidth,this.layer.outlineColor),o(e,t,this.layer.data,this.layer.weight)},detach(){this.view.container.removeChild(this.canvas)}});t=e.createSubclass({properties:{min:0,max:1,palette:{0:"green",.5:"yellow",1:"red"},weight:5,outlineWidth:1,outlineColor:"black"},constructor:e=>{this.min=e.min,this.max=e.max,a()},createLayerView:function(e){if("2d"===e.type)return new i({view:e,layer:this})}});let r=(e,t,i,r,a,o)=>{var n,l,h,s,c;if(a)for(n=0,h=i.length;n<h;n++)for(s=i[n],e.lineWidth=r+2*a,l=1,c=s.length;l<c;l++){var d=s[l-1],g=s[l],d=new y({longitude:d[0],latitude:d[1]}),g=new y({longitude:g[0],latitude:g[1]}),d=m.geographicToWebMercator(d),g=m.geographicToWebMercator(g),u=[0,0],d=(t.toScreen(u,d.x,d.y),[0,0]);t.toScreen(d,g.x,g.y),e.strokeStyle=o,e.beginPath(),e.moveTo(u[0],u[1]),e.lineTo(d[0],d[1]),e.stroke()}},a=()=>{var e,t={0:"green",.5:"yellow",1:"red"},i=document.createElement("canvas"),r=i.getContext("2d"),a=r.createLinearGradient(0,0,0,256);for(e in i.width=1,i.height=256,t)a.addColorStop(e,t[e]);r.fillStyle=a,r.fillRect(0,0,1,256),this.palette=r.getImageData(0,0,1,256).data},o=(e,t,i,r)=>{var a,o,n,l,h;for(e.lineWidth=r,a=0,n=i.length;a<n;a++)for(o=1,h=(l=i[a]).length;o<h;o++){var s=l[o-1],c=l[o],d=new y({longitude:s[0],latitude:s[1]}),g=new y({longitude:c[0],latitude:c[1]}),d=m.geographicToWebMercator(d),g=m.geographicToWebMercator(g),u=[0,0],d=(t.toScreen(u,d.x,d.y),[0,0]);t.toScreen(d,g.x,g.y),g=e.createLinearGradient(u[0],u[1],d[0],d[1]),s=w(s[2]),c=w(c[2]),g.addColorStop(0,"rgb("+s.join(",")+")"),g.addColorStop(1,"rgb("+c.join(",")+")"),e.strokeStyle=g,e.beginPath(),e.moveTo(u[0],u[1]),e.lineTo(d[0],d[1]),e.stroke()}},w=e=>{e=Math.min(Math.max((e-this.min)/(this.max-this.min),0),.999),e=4*Math.floor(256*e);return[this.palette[e],this.palette[1+e],this.palette[2+e]]};return t});
